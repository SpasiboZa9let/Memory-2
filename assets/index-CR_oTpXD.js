function l(n,t=document){return t.querySelector(n)}class a{constructor(t,s,e){if(this.mapEl=l(t),this.markers=s,this.panel=e,!this.mapEl){console.error(`Map container "${t}" not found`);return}this.mapEl.style.position="relative",this._onResize=this._renderMarkers.bind(this),window.addEventListener("resize",this._onResize),this._renderMarkers()}_renderMarkers(){this.mapEl.querySelectorAll(".marker").forEach(e=>e.remove());const{width:t,height:s}=this.mapEl.getBoundingClientRect();this.markers.forEach(e=>{if(e.x<0||e.x>1||e.y<0||e.y>1)return;const i=document.createElement("div");i.className="marker",i.style.left=`${e.x*t}px`,i.style.top=`${e.y*s}px`,i.style.backgroundImage=`url(${e.img})`,i.title=e.title||"",i.addEventListener("click",()=>{var o;(o=this.panel)!=null&&o.ready&&this.panel.show(e)}),this.mapEl.appendChild(i)})}destroy(){window.removeEventListener("resize",this._onResize)}}class c{constructor(t){this.panel=document.querySelector(t),this.img=document.createElement("img"),this.caption=document.createElement("div"),this.panel.appendChild(this.img),this.panel.appendChild(this.caption),this.panel.style.display="none",this.ready=!0}show(t){this.ready&&(this.ready=!1,this.img.src=t.img,this.caption.textContent=t.title||"Без подписи",this.panel.style.display="block",setTimeout(()=>{this.ready=!0},3e3))}hide(){this.panel.style.display="none",this.ready=!0}}class h{constructor(t,s,e){this.bar=document.querySelector(s),this.btn=document.querySelector(e),console.log("Прогрессбар инициализирован")}}const r=[{x:.5,y:.5,img:"photos/1.jpg",title:"Пример"}];function d(){console.log("Рисуем маршрут (заглушка)")}class p{constructor(){this.enabled=!1}initOnce(){this.enabled=!0,console.log("Звук включён")}toggle(){return this.enabled=!this.enabled,this.enabled}}function u(){const n=new c("#memory-panel");new a("#map",r,n),new h(r.length,"#progress-bar","#open-album"),d();const t=new p;document.addEventListener("click",()=>t.initOnce(),{once:!0})}export{u as initMap};
