function y(s,e=document){return e.querySelector(s)}class g{constructor(e,i,t){if(this.mapEl=y(e),this.markers=i,this.panel=t,!this.mapEl){console.error(`Map container "${e}" not found`);return}this.mapEl.style.position="relative",this._onResize=this._renderMarkers.bind(this),window.addEventListener("resize",this._onResize),this._renderMarkers()}_renderMarkers(){this.mapEl.querySelectorAll(".marker").forEach(t=>t.remove());const{width:e,height:i}=this.mapEl.getBoundingClientRect();this.markers.forEach(t=>{if(t.x<0||t.x>1||t.y<0||t.y>1)return;const n=document.createElement("div");n.className="marker",n.style.left=`${t.x*e}px`,n.style.top=`${t.y*i}px`,n.style.backgroundImage=`url(${t.img})`,n.title=t.title||"",n.addEventListener("click",()=>{var r;(r=this.panel)!=null&&r.ready&&this.panel.show(t)}),this.mapEl.appendChild(n)})}destroy(){window.removeEventListener("resize",this._onResize)}}class w{constructor(e){this.panel=document.querySelector(e),this.img=document.createElement("img"),this.caption=document.createElement("div"),this.panel.appendChild(this.img),this.panel.appendChild(this.caption),this.panel.style.display="none",this.ready=!0}show(e){this.ready&&(this.ready=!1,this.img.src=e.img,this.caption.textContent=e.title||"Без подписи",this.panel.style.display="block",setTimeout(()=>{this.ready=!0},3e3))}hide(){this.panel.style.display="none",this.ready=!0}}class b{constructor(e,i,t){this.bar=document.querySelector(i),this.btn=document.querySelector(t),console.log("Прогрессбар инициализирован")}}const h=[{x:.5,y:.5,img:"photos/1.jpg",title:"Пример"}];function f(){const s=Array.from(document.querySelectorAll(".marker"));if(s.length<2)return;const e=document.getElementById("map"),i=e.getBoundingClientRect(),t=s.map(c=>{const o=c.getBoundingClientRect();return{x:o.left+o.width/2-i.left,y:o.top+o.height/2-i.top}}),n=[];n.push(`M ${t[0].x},${t[0].y}`);for(let c=1;c<t.length;c++){const o=t[c-1],a=t[c],d=o.x+(a.x-o.x)/3,u=o.y,p=o.x+2*(a.x-o.x)/3,m=a.y;n.push(`C ${d},${u} ${p},${m} ${a.x},${a.y}`)}const r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.setAttribute("viewBox",`0 0 ${i.width} ${i.height}`),r.setAttribute("style","position:absolute; top:0; left:0; pointer-events:none; z-index:5;");const l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d",n.join(" ")),l.setAttribute("fill","none"),l.setAttribute("stroke","#7a6f5a"),l.setAttribute("stroke-width","2"),l.setAttribute("stroke-linecap","round"),r.appendChild(l),e.appendChild(r)}class x{constructor(){this.enabled=!1}initOnce(){this.enabled=!0,console.log("Звук включён")}toggle(){return this.enabled=!this.enabled,this.enabled}}function E(){const s=new w("#memory-panel");new g("#map",h,s),new b(h.length,"#progress-bar","#open-album"),setTimeout(f,100);const e=new x;document.addEventListener("click",()=>e.initOnce(),{once:!0})}export{E as initMap};
